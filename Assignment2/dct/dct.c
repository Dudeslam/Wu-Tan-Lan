#include <stdio.h>
#include <math.h>
#include "dct.h"

#define NumberOf(a) (sizeof (a) / sizeof *(a))


static void DCTII(size_t N, float *y, const float *x)
{
    static const float Pi = 0x3.243f6a8885a308d313198a2e03707344ap0f;

    for (size_t k = 0; k < N; ++k)
    {
        float sum = 0;
        for (size_t n = 0; n < N; ++n)
            sum += x[n] * cosf(Pi/N * (n + .5) * k);
        y[k] = sum;
    }
}


int main(void)
{
    //float ECGSignal[] = {0.35, 0.35, -0.37, -0.335, -0.285, -0.23, -0.215};
    float ECGSignal[512] = {0.3500, 0.3500, 0.3500, 0.3500, 0.3500, 0.3500, 0.3500, 0.3500, 0.3500, 0.02000, -0.2100, -0.3300, -0.3700, -0.3350, -0.2850, -0.2300, -0.2150, -0.2000, -0.1900, -0.2000, -0.2000, -0.2100, -0.2300, -0.2500, -0.2550, -0.2450, -0.2400, -0.2150, -0.2350, -0.2300, -0.2300, -0.2050, -0.1800, -0.1650, -0.1950, -0.2100, -0.2150, -0.1950, -0.1700, -0.1550, -0.1750, -0.1950, -0.2100, -0.2000, -0.2000, -0.1950, -0.1850, -0.1850, -0.1800, -0.1750, -0.1750, -0.1650, -0.1400, -0.1200, -0.1150, -0.1300, -0.1550, -0.1900, -0.1900, -0.1850, -0.1800, -0.1600, -0.1400, -0.1300, -0.1100, -0.1200, -0.1300, -0.1300, -0.1250, -0.09500, -0.09500, -0.09000, -0.08000, -0.07500, -0.07000, -0.07500, -0.06500, -0.05500, -0.06000, -0.05500, -0.04000, -0.03000, -0.02000, -0.01500, -0.01500, -0.01000, 0.01500, 0.03500, 0.02500, 0.01500, 0.01500, 0.02500, 0.02500, 0.04000, 0.04000, 0.03000, 0.01500, 0.02000, 0.03500, 0.04500, 0.05000, 0.02500, 0.02000, 0.02000, 0.01000, 0.01000, 0, -0.005000, -0.02500, -0.02000, -0.03000, -0.03000, -0.03500, -0.04500, -0.05500, -0.06000, -0.06500, -0.07500, -0.08000, -0.07500, -0.07500, -0.07500, -0.07000, -0.07500, -0.08000, -0.09000, -0.1000, -0.09500, -0.09500, -0.08500, -0.09500, -0.1000, -0.1000, -0.1150, -0.1150, -0.1300, -0.1400, -0.1500, -0.1600, -0.1450, -0.1550, -0.1600, -0.1700, -0.1850, -0.1750, -0.1700, -0.1650, -0.1700, -0.1700, -0.1650, -0.1800, -0.1800, -0.2000, -0.2000, -0.2150, -0.2050, -0.2100, -0.2050, -0.2100, -0.2200, -0.2250, -0.2250, -0.2400, -0.2250, -0.2100, -0.2050, -0.1950, -0.1900, -0.2000, -0.1900, -0.1900, -0.1850, -0.1700, -0.1700, -0.1750, -0.1650, -0.1650, -0.1850, -0.1850, -0.2050, -0.2050, -0.2100, -0.1950, -0.1950, -0.1900, -0.1950, -0.1950, -0.1950, -0.1850, -0.1750, -0.1750, -0.2000, -0.2250, -0.2500, -0.2400, -0.2400, -0.2400, -0.2500, -0.2600, -0.2700, -0.2800, -0.3050, -0.3350, -0.3500, -0.3400, -0.2850, -0.2050, -0.1350, -0.09500, -0.04500, 0.01000, 0.07500, 0.1400, 0.1750, 0.1350, 0.04500, -0.1550, -0.4250, -0.7100, -0.9150, -1.090, -1.255, -1.395, -1.465, -1.505, -1.490, -1.450, -1.390, -1.340, -1.270, -1.155, -1.025, -0.9500, -0.9300, -0.9300, -0.9100, -0.8850, -0.8650, -0.8400, -0.8000, -0.7550, -0.7150, -0.6600, -0.6300, -0.5800, -0.5400, -0.5100, -0.4650, -0.4350, -0.3950, -0.3650, -0.3150, -0.2650, -0.2000, -0.1550, -0.09000, -0.04000, -0.01500, -0.01000, 0.005000, 0.03000, 0.05500, 0.08000, 0.08500, 0.09000, 0.1100, 0.1100, 0.1300, 0.1500, 0.1550, 0.1500, 0.1800, 0.1850, 0.2050, 0.2200, 0.2350, 0.2350, 0.2550, 0.2700, 0.2900, 0.2900, 0.3000, 0.3000, 0.3050, 0.3250, 0.3150, 0.3100, 0.3150, 0.3150, 0.3450, 0.3600, 0.3700, 0.3750, 0.3750, 0.3650, 0.3750, 0.3850, 0.4100, 0.4050, 0.4000, 0.4000, 0.4050, 0.4000, 0.4100, 0.3950, 0.4000, 0.3850, 0.3900, 0.3950, 0.3850, 0.3800, 0.3550, 0.3550, 0.3550, 0.3500, 0.3250, 0.3000, 0.2800, 0.2500, 0.2500, 0.2500, 0.2500, 0.2350, 0.2100, 0.1750, 0.1650, 0.1600, 0.1450, 0.1400, 0.1450, 0.1300, 0.1000, 0.08000, 0.04000, 0.01500, -0.01000, -0.02500, -0.02500, -0.03000, -0.04000, -0.04500, -0.07000, -0.1050, -0.08000, -0.07500, -0.08500, -0.09000, -0.1100, -0.1300, -0.1200, -0.1150, -0.1250, -0.1500, -0.1700, -0.1600, -0.1600, -0.1500, -0.1550, -0.1600, -0.1700, -0.1850, -0.1800, -0.1800, -0.1900, -0.1800, -0.1700, -0.1600, -0.1400, -0.1400, -0.1450, -0.1700, -0.1800, -0.1750, -0.1600, -0.1550, -0.1550, -0.1650, -0.1500, -0.1550, -0.1500, -0.1450, -0.1450, -0.1650, -0.1950, -0.2050, -0.1900, -0.1800, -0.1650, -0.1700, -0.1600, -0.1700, -0.1650, -0.1700, -0.1700, -0.1700, -0.1700, -0.1850, -0.1900, -0.1800, -0.1800, -0.1800, -0.1750, -0.2000, -0.2100, -0.2000, -0.2000, -0.2100, -0.2150, -0.2100, -0.2000, -0.1750, -0.1600, -0.1450, -0.1450, -0.1350, -0.1400, -0.1350, -0.1300, -0.1200, -0.1150, -0.1100, -0.1050, -0.1000, -0.09500, -0.1100, -0.1400, -0.1750, -0.1800, -0.1800, -0.1800, -0.1650, -0.1750, -0.1750, -0.1750, -0.1650, -0.1650, -0.1650, -0.1750, -0.1650, -0.1600, -0.1550, -0.1500, -0.1550, -0.1600, -0.1600, -0.1550, -0.1450, -0.1500, -0.1500, -0.1850, -0.2000, -0.2000, -0.1950, -0.1900, -0.1900, -0.1950, -0.2000, -0.1950, -0.1850, -0.1750, -0.1750, -0.1550, -0.1700, -0.1700, -0.1650, -0.1500, -0.1600, -0.1650, -0.1750, -0.1700, -0.1700, -0.1850, -0.2150, -0.2250, -0.1900, -0.1250, -0.04000, 0.05000, 0.1250, 0.2150, 0.3200, 0.4150, 0.5000, 0.6050, 0.7250, 0.8450, 0.9400, 1.060, 1.110, 1.100, 1.005, 0.8600, 0.6150, 0.2400, -0.1100, -0.3350, -0.4600, -0.5150, -0.5400, -0.5100, -0.4400, -0.3850, -0.3600, -0.3500, -0.3350, -0.3200, -0.2950, -0.3000, -0.3000, -0.3250, -0.3350, -0.3350};
    float result[NumberOf(ECGSignal)];

    DCTII(NumberOf(ECGSignal), result, ECGSignal);

    for (size_t i = 0; i < NumberOf(result); ++i)
        printf("y[%zu] = %g.\n", i, result[i]);
}
